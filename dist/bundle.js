(()=>{var e={571:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("UserModel",i);e.exports=c},905:(e,s,o)=>{(()=>{var e={571:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:(e,s,o)=>{(()=>{var e={905:()=>{},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=true&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=true&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=true&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(770);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},770:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905),r(770);var f=l.model("User");o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},661:(e,s,o)=>{const r=o(185),t=o(96);o(142).config({path:__dirname+"/process.env"});const n=o(396),i=new r.Schema({name:{type:String,required:!0,unique:!0,set:n()},email:{type:String,required:!0,unique:!0,match:/^\S+@\S+\.\S+$/},password:{type:String,required:!0},isActive:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1}});i.methods.validatePassword=async function(e){return await t.compare(e,this.password)};const c=r.model("User",i);e.exports=c},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(661);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=o(96)},986:e=>{"use strict";e.exports=o(986)},383:e=>{"use strict";e.exports=o(383)},730:e=>{"use strict";e.exports=o(730)},347:e=>{"use strict";e.exports=o(347)},142:e=>{"use strict";e.exports=o(142)},632:e=>{"use strict";e.exports=o(632)},860:e=>{"use strict";e.exports=o(860)},508:e=>{"use strict";e.exports=o(508)},567:e=>{"use strict";e.exports=o(567)},13:e=>{"use strict";e.exports=o(13)},185:e=>{"use strict";e.exports=o(185)},511:e=>{"use strict";e.exports=o(511)},55:e=>{"use strict";e.exports=o(55)},396:e=>{"use strict";e.exports=o(396)}},s={};function r(o){var t=s[o];if(void 0!==t)return t.exports;var n=s[o]={exports:{}};return e[o](n,n.exports,r),n.exports}(()=>{const e=r(860),s=r(508),o=e(),t=r(339),n=r(986);r(632),r(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=r(13),c=r(511),a=r(55).Strategy,l=r(185),u=r(383),d=r(347).randomBytes(64).toString("hex"),p=r(96),g=r(730),h=r(567),m=r(396);r(905);const f=r(571);o.set("view engine","ejs"),t(o),o.use(e.static("./public")),o.use("/",e.static("./public")),o.use(n.urlencoded({extended:!1})),o.use(h("_method")),o.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),o.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),o.use(c.initialize()),o.use(c.session()),o.use(u()),o.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),o.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),o.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),o.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),o.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),o.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),o.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),o.listen(3100),console.log("You are listening to port 3100...")})()})()},339:e=>{e.exports=e=>{e.get("/crowdsource",((e,s)=>{s.render("crowdsource")}))}},96:e=>{"use strict";e.exports=require("bcrypt")},986:e=>{"use strict";e.exports=require("body-parser")},383:e=>{"use strict";e.exports=require("connect-flash")},730:e=>{"use strict";e.exports=require("connect-mongo")},347:e=>{"use strict";e.exports=require("crypto")},142:e=>{"use strict";e.exports=require("dotenv")},632:e=>{"use strict";e.exports=require("ejs")},860:e=>{"use strict";e.exports=require("express")},508:e=>{"use strict";e.exports=require("express-session")},567:e=>{"use strict";e.exports=require("method-override")},13:e=>{"use strict";e.exports=require("mongodb")},185:e=>{"use strict";e.exports=require("mongoose")},511:e=>{"use strict";e.exports=require("passport")},55:e=>{"use strict";e.exports=require("passport-local")},396:e=>{"use strict";e.exports=require("xss-clean")}},s={};function o(r){var t=s[r];if(void 0!==t)return t.exports;var n=s[r]={exports:{}};return e[r](n,n.exports,o),n.exports}(()=>{const e=o(860),s=o(508),r=e(),t=o(339),n=o(986);o(632),o(142).config({path:__dirname+"/process.env"});const{MongoClient:i}=o(13),c=o(511),a=o(55).Strategy,l=o(185),u=o(383),d=o(347).randomBytes(64).toString("hex"),p=o(96),g=o(730),h=o(567),m=o(396);o(905);const f=o(571);r.set("view engine","ejs"),t(r),r.use(e.static("./public")),r.use("/",e.static("./public")),r.use(n.urlencoded({extended:!1})),r.use(h("_method")),r.use(m());const y="mongodb+srv://admin:ohyH22ABIIgktbby@cluster0.alu0pdy.mongodb.net/?retryWrites=false&w=majority";function w(e,s,o){if(e.isAuthenticated())return console.log("islogged in deserialize"),o();e.flash("error","You must be logged in to access this page"),console.log(e.flash()),s.redirect("/")}l.connect(y,{useNewUrlParser:!0,useUnifiedTopology:!0}),c.use(new a({usernameField:"email",passwordField:"password"},(async(e,s,o)=>{try{const r=await f.findOne({email:e});return r?!r.isActive||r.isLocked?o(null,!1,{errors:{user:"is not active or is locked"}}):await r.validatePassword(s)?o(null,r):o(null,!1,{errors:{"email or password":"is invalid"}}):o(null,!1,{errors:{"email or password":"is invalid"}})}catch(e){o(e)}}))),c.serializeUser(((e,s)=>{try{if(!e.id)throw new Error("User object does not contain an id property");const{id:o}=e;console.log("serialize"),console.log(e.id),s(null,o)}catch(e){s(e)}})),c.deserializeUser((async(e,s)=>{try{const o=await f.findById(e);if(!o)throw new Error(`User with id ${e} not found`);console.log("deserialize"),console.log(o.id),s(null,o)}catch(e){s(e)}})),r.use(s({secret:d,store:g.create({mongoUrl:y}),resave:!1,saveUninitialized:!1,cookie:{secure:!1}})),r.use(c.initialize()),r.use(c.session()),r.use(u()),r.get("/",((e,s)=>{e.isAuthenticated()?s.render("home",{name:e.user.name}):s.render("loginSignup",{messages:e.flash()})})),r.post("/login",m(),((e,s,o)=>{c.authenticate("local",((r,t)=>r?o(r):t?void e.logIn(t,(r=>r?o(r):(e.flash("success","You have successfully logged in!"),console.log(e.flash()),s.redirect("/home")))):(e.flash("error","Invalid email or password"),console.log(e.flash()),s.redirect("/"))))(e,s,o)})),r.post("/signup",m(),((e,s,o)=>{const{name:r,email:t,password:n}=e.body;console.log("name before saving in db:"+r),f.findOne({email:t}).then((o=>o?(e.flash("error","Email already exists"),console.log(e.flash()),s.redirect("/")):p.hash(n,10))).then((e=>new f({name:r,email:t,password:e}).save())).then((()=>{e.flash("success","You have successfully signed up! Now you can log in."),console.log(e.flash()),s.redirect("/")})).catch((e=>{o(e)}))})),r.get("/home",w,(function(e,s){s.render("home",{name:e.user.name})})),r.get("/explore",w,((e,s)=>{console.log(e.user),s.render("explore")})),r.delete("/logout",((e,s,o)=>{e.session.destroy((function(r){if(r)return o(r);console.log(e.user),s.redirect("/")}))}));const v=new i(y,{useNewUrlParser:!0});(async function(){try{await v.connect(),await v.db("lecture").command({ping:1}),console.log("Connected successfully to MongoDB server")}finally{await v.close()}})().catch(console.dir),r.post("/videoConsole",w,((e,s)=>{const o=e.body.branch,r=e.body.section,t=e.body.subject;v.connect((e=>{if(e)return void console.log("Error connecting to MongoDB server:",e);const n=v.db("lecture").collection("videos");var i={branch_code:o,section:r,subject_code:t};n.find(i).sort({lecture_no:1}).toArray(((e,n)=>{e?console.log("Error executing query:",e):s.render("videoConsole",{print:n,branch:o,section:r,subject:t})}))}))})),r.listen(3100),console.log("You are listening to port 3100...")})()})();
//# sourceMappingURL=bundle.js.map